# Build and Deployment

This document describes how to trigger automated builds and deployments for ALP Experimental.

## Automated Builds

The project uses GitHub Actions to automatically build and push Docker images to GitHub Container Registry (ghcr.io). Builds are triggered by Git tags, not every commit.

### Triggering a Build

#### Option 1: Use the Build Script (Recommended)

**Linux/macOS:**
```bash
./build.sh
```

**Windows:**
```cmd
build.bat
```

The script will:
1. Generate a timestamp tag (format: `build-YYYYMMDD-HHMMSS`)
2. Create and push the tag to trigger the build
3. Provide a link to monitor the build progress

#### Option 2: Manual Tag Creation

```bash
# Generate timestamp
TIMESTAMP=$(date +"%Y%m%d-%H%M%S")
TAG_NAME="build-${TIMESTAMP}"

# Create and push tag
git tag "${TAG_NAME}" -m "Manual build trigger - ${TIMESTAMP}"
git push origin "${TAG_NAME}"
```

#### Option 3: Version Tags

For release builds, push semantic version tags:
```bash
git tag "v1.0.0" -m "Release v1.0.0"
git push origin "v1.0.0"
```

### Build Triggers

The GitHub Actions workflow triggers on:
- **Build tags**: `build-*` (generated by scripts)
- **Version tags**: `v*` (semantic versioning)
- **Manual dispatch**: Via GitHub Actions UI

### Generated Images

Each build creates multi-platform (amd64/arm64) Docker images:
- `ghcr.io/astrophotograph/alp-experimental-ui`
- `ghcr.io/astrophotograph/alp-experimental-server`

### Image Tags

Every build generates multiple tags:
- `latest` (for main branch builds)
- `YYYYMMDD-HHMMSS` (timestamp - always included)
- `TAG-abc1234` (tag name + short commit SHA)
- `v1.0.0`, `v1.0`, `v1` (for semantic version tags)

### Monitoring Builds

- View build status: https://github.com/astrophotograph/alp-experimental/actions
- Check package registry: https://github.com/astrophotograph/alp-experimental/pkgs/container/alp-experimental-ui

### Cleanup

To delete a build tag if needed:
```bash
# Delete locally and remotely
git tag -d build-20240719-143022
git push origin --delete build-20240719-143022
```

## Development Builds

For local development and testing, use the existing Docker Compose setup:

```bash
# Development environment
make dev

# Production environment  
make prod

# Run tests
make test

# Run linting
make lint
```